function AOTfeature(fhandle,varargin)
%
% Activates the Always-On-Top feature of a figure
% 
% INPUT: handle to a figure
% 
% OUTPUT: none
%

%
% >> Project Dyn:Ammo - EUROSTAT module, release 2019-Jan-30
% >> Written by: Jakub Rysanek
%

% keyboard;

drawnow;

w = warning;
warning('off','MATLAB:HandleGraphics:ObsoletedProperty:JavaFrame');
jhandle = get(fhandle,'JavaFrame');
warning(w);

if dynammo.compatibility.newGraphics
    if jhandle.fHG2Client.getWindow.isAlwaysOnTop
        jhandle.fHG2Client.getWindow.setAlwaysOnTop(0);
        ison = 0;
    else
        jhandle.fHG2Client.getWindow.setAlwaysOnTop(1);
        ison = 1;
    end    
else
    if jhandle.fHG1Client.getWindow.isAlwaysOnTop
        jhandle.fHG1Client.getWindow.setAlwaysOnTop(0);
        ison = 0;
    else
        jhandle.fHG1Client.getWindow.setAlwaysOnTop(1);
        ison = 1;
    end
end

if nargin==2
    % aothandle = varargin{1};
    set(varargin{1},'CData',reset_AOT_image(ison));
end

%% Nested function
    function img = reset_AOT_image(status)
        if ~status % AOT is on
            img(:,:,1) = [
              255  255  255  255  255  255  255  255  255  255  255  255  255  255  255  255
              255  255  255  255  255  255   50   50   50   50  255  255  255  255  255  255
              255  255  255  255   50   50  203  231  231  203   50   43  255  255  255  255
              255  255  255   50  203  231  231  231  231  231  231  203   43  255  255  255
              255  255   43  203  231  231  231  231  231  231  231  231  203   43  255  255
              255  255   43  231  231  255  255  231  231  231  231  231  231   43  255  255
              255   43  193  231  231  255  231  231  231  231  231  231  231  193   43  255
              255   34  193  231  231  231  157   66   66  157  231  231  231  193   34  255
              255   34  193  231  231  157   75  201   91   66  157  231  231  193   34  255
              255   34  193  193  231   66  157   51   22   91   66  231  193  193   34  255
              255  255   34  193  193   57   91   22   22   91   57  193  193   34  255  255
              255  255   34  193  193  157   57   80   80   57  157  193  193   34  255  255
              255  255  255   28  193  193  157   57   57  157  193  193   28  255  255  255
              255  255  220  220   28   28  193  193  193  193   28   28  220  220  255  255
              255  220  220  220  220  220   28   28   28   28  220  220  220  220  220  255
              255  255  220  220  220  220  220  220  220  220  220  220  220  220  255  255];

            img(:,:,2) = [
              255  255  255  255  255  255  255  255  255  255  255  255  255  255  255  255
              255  255  255  255  255  255   85   85   85   85  255  255  255  255  255  255
              255  255  255  255   85   85  203  231  231  203   85   73  255  255  255  255
              255  255  255   85  203  231  231  231  231  231  231  203   73  255  255  255
              255  255   73  203  231  231  231  231  231  231  231  231  203   73  255  255
              255  255   73  231  231  255  255  231  231  231  231  231  231   73  255  255
              255   73  193  231  231  255  231  231  231  231  231  231  231  193   73  255
              255   58  193  231  231  231  184  106  106  184  231  231  231  193   58  255
              255   58  193  231  231  184  120  220  133  106  184  231  231  193   58  255
              255   58  193  193  231  106  184   95   22  133  106  231  193  193   58  255
              255  255   58  193  193   91  133   22   22  133   91  193  193   58  255  255
              255  255   58  193  193  184   91  116  116   91  184  193  193   58  255  255
              255  255  255   47  193  193  184   91   91  184  193  193   47  255  255  255
              255  255  220  220   47   47  193  193  193  193   47   47  220  220  255  255
              255  220  220  220  220  220   47   47   47   47  220  220  220  220  220  255
              255  255  220  220  220  220  220  220  220  220  220  220  220  220  255  255];

            img(:,:,3) = [
              255  255  255  255  255  255  255  255  255  255  255  255  255  255  255  255
              255  255  255  255  255  255  115  115  115  115  255  255  255  255  255  255
              255  255  255  255  115  115  210  231  231  210  115   99  255  255  255  255
              255  255  255  115  210  231  231  231  231  231  231  210   99  255  255  255
              255  255   99  210  231  231  231  231  231  231  231  231  210   99  255  255
              255  255   99  231  231  255  255  231  231  231  231  231  231   99  255  255
              255   99  193  231  231  255  231  231  231  231  231  231  231  193   99  255
              255   79  193  231  231  231  207  140  140  207  231  231  231  193   79  255
              255   79  193  231  231  207  158  236  169  140  207  231  231  193   79  255
              255   79  193  193  231  140  207  133   22  169  140  231  193  193   79  255
              255  255   79  193  193  120  169   22   22  169  120  193  193   79  255  255
              255  255   79  193  193  207  120  148  148  120  207  193  193   79  255  255
              255  255  255   64  193  193  207  120  120  207  193  193   64  255  255  255
              255  255  220  220   64   64  193  193  193  193   64   64  220  220  255  255
              255  220  220  220  220  220   64   64   64   64  220  220  220  220  220  255
              255  255  220  220  220  220  220  220  220  220  220  220  220  220  255  255];
            img = img/255;
        else
            img(:,:,1) = [
              237  237  255  255  255  255  255  255  255  255  255  255  255  255  237  237
              237  255  255  255  255  255   50   50   50   50  255  255  255  255  255  237
              255  255  255  255   50   50  203  231  231  203   50   43  255  255  255  255
              255  255  255   50  203  231  231  231  231  231  231  203   43  255  255  255
              255  255   43  203  231  231  231  231  231  231  231  231  203   43  255  255
              255  255   43  231  231  255  255  231  231  231  231  231  231   43  255  255
              255   43  193  231  231  255  231  231  231  231  231  231  231  193   43  255
              255   34  193  231  231  231  157   66   66  157  231  231  231  193   34  255
              255   34  193  231  231  157   75  201   91   66  157  231  231  193   34  255
              255   34  193  193  231   66  157   51   22   91   66  231  193  193   34  255
              255  255   34  193  193   57   91   22   22   91   57  193  193   34  255  255
              255  255   34  193  193  157   57   80   80   57  157  193  193   34  255  255
              255  255  255   28  193  193  157   57   57  157  193  193   28  255  255  255
              255  255  220  220   28   28  193  193  193  193   28   28  220  220  255  255
              237  220  220  220  220  220   28   28   28   28  220  220  220  220  220  237
              237  237  220  220  220  220  220  220  220  220  220  220  220  220  237  237];
            img(:,:,2) = [
               28   28  255  255  255  255  255  255  255  255  255  255  255  255   28   28
               28  255  255  255  255  255   85   85   85   85  255  255  255  255  255   28
              255  255  255  255   85   85  203  231  231  203   85   73  255  255  255  255
              255  255  255   85  203  231  231  231  231  231  231  203   73  255  255  255
              255  255   73  203  231  231  231  231  231  231  231  231  203   73  255  255
              255  255   73  231  231  255  255  231  231  231  231  231  231   73  255  255
              255   73  193  231  231  255  231  231  231  231  231  231  231  193   73  255
              255   58  193  231  231  231  184  106  106  184  231  231  231  193   58  255
              255   58  193  231  231  184  120  220  133  106  184  231  231  193   58  255
              255   58  193  193  231  106  184   95   22  133  106  231  193  193   58  255
              255  255   58  193  193   91  133   22   22  133   91  193  193   58  255  255
              255  255   58  193  193  184   91  116  116   91  184  193  193   58  255  255
              255  255  255   47  193  193  184   91   91  184  193  193   47  255  255  255
              255  255  220  220   47   47  193  193  193  193   47   47  220  220  255  255
               28  220  220  220  220  220   47   47   47   47  220  220  220  220  220   28
               28   28  220  220  220  220  220  220  220  220  220  220  220  220   28   28];
            img(:,:,3) = [
               36   36  255  255  255  255  255  255  255  255  255  255  255  255   36   36
               36  255  255  255  255  255  115  115  115  115  255  255  255  255  255   36
              255  255  255  255  115  115  210  231  231  210  115   99  255  255  255  255
              255  255  255  115  210  231  231  231  231  231  231  210   99  255  255  255
              255  255   99  210  231  231  231  231  231  231  231  231  210   99  255  255
              255  255   99  231  231  255  255  231  231  231  231  231  231   99  255  255
              255   99  193  231  231  255  231  231  231  231  231  231  231  193   99  255
              255   79  193  231  231  231  207  140  140  207  231  231  231  193   79  255
              255   79  193  231  231  207  158  236  169  140  207  231  231  193   79  255
              255   79  193  193  231  140  207  133   22  169  140  231  193  193   79  255
              255  255   79  193  193  120  169   22   22  169  120  193  193   79  255  255
              255  255   79  193  193  207  120  148  148  120  207  193  193   79  255  255
              255  255  255   64  193  193  207  120  120  207  193  193   64  255  255  255
              255  255  220  220   64   64  193  193  193  193   64   64  220  220  255  255
               36  220  220  220  220  220   64   64   64   64  220  220  220  220  220   36
               36   36  220  220  220  220  220  220  220  220  220  220  220  220   36   36];
            img = img/255;
        end
    end %<reset_AOT_image>

end %<eof>