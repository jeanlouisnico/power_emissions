function res = dbload_tseries(CSVfile,exploded)
%
% Loads CSV database generated by IRIS
%
% INPUT: CSVfile ...input database
%        exploded ...flag indicating the output format (tsobj() versus struct of tsobj())
% 
% OUTPUT: res ...tsobj()
%

%
% >> Project Dyn:Ammo - EUROSTAT module, release 2019-Jan-30
% >> Written by: Jakub Rysanek
%

% keyboard;

%% Input validation
if ~ischar(CSVfile)
   error_msg('Input format','String indicating file name expected on input...'); 
end
if nargin==2
    if ~any(exploded==[1;0])
       error_msg('Explosion','[0/1] flag expected on input...'); 
    end
else
    exploded = 1;% Default
end

%% Body

db = import_data(CSVfile,'delimiter','","');

db = strrep(db,'"','');

range = db(4:end,1);
vals = cellfun(@eval,db(4:end,2:end));
names = db(2,2:end);
technames = db(1,2:end);

res = tsobj(range,vals,names);
res.techname = technames;

if exploded==1
    res = explode(res);
end

end %<eof>